<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="I like to keep my bash prompt clean and simple. Learn how to setup a minimal bash prompt." />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <title>Customize your Bash Prompt - Kunal Nagar</title>
    <meta
      property="og:image"
      content="https://kunalnagar.in/assets/img/post.png"
    />
    <meta property="og:title" content="Customize your Bash Prompt - Kunal Nagar" />
    <meta property="og:description" content="I like to keep my bash prompt clean and simple. Learn how to setup a minimal bash prompt." />
    <meta property="og:url" content="https://kunalnagar.in/blog/customize-bash-prompt/" />
    <meta property="og:type" content="article" />
    <meta name="robots" content="index, follow" />
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"
    ></script>
  </head>
  <body>
    <main>
      <nav>
  <ul>
    <li>
      <a title="Home" href="/" class="d--flex"
        ><svg
          version="1.0"
          xmlns="http://www.w3.org/2000/svg"
          width="35px"
          height="35px"
          viewBox="0 0 412.000000 416.000000"
          preserveAspectRatio="xMidYMid meet"
        >
          <g
            transform="translate(0.000000,416.000000) scale(0.100000,-0.100000)"
            fill="#000000"
            stroke="none"
          >
            <path
              d="M0 2070 l0 -2070 2060 0 2060 0 0 2070 0 2070 -2060 0 -2060 0 0
     -2070z m1780 296 c0 -215 4 -377 9 -380 5 -4 18 5 28 18 10 13 168 184 351
     380 l333 356 90 0 c51 0 89 -4 87 -9 -1 -5 -109 -126 -239 -268 -321 -351
     -305 -332 -292 -351 5 -10 134 -181 287 -382 152 -201 276 -368 276 -372 0 -5
     -41 -8 -90 -8 l-90 0 -251 336 c-138 184 -254 334 -257 332 -4 -2 -60 -58
     -124 -124 l-118 -122 0 -211 0 -211 -85 0 -85 0 0 695 0 695 85 0 85 0 0 -374z"
            />
          </g></svg
      ></a>
    </li>
    <li><a href="/assets/downloads/Resume-KunalNagar.pdf">Resume</a></li>
    <li><a href="/foss">Open Source</a></li>
    <li><a href="/blog">Blog</a></li>
  </ul>
</nav>

      <div class="page-blog-single">
        <h1>Customize your Bash Prompt</h1>
        <time>February 23, 2019</time>
        <article><p>I like to keep my bash prompt really minimal. I’m not into colours. I’m not into fancy fonts. I want my prompt to show contextual information so I can focus on the work I’m doing.</p>

<p>By default, macOS gives you this terminal:</p>

<!-- prettier-ignore -->
<p><a href="https://i.imgur.com/n57DPG3.png" aria-label="" data-lightbox="https://i.imgur.com/n57DPG3.png" class="lightbox-img">
  <img src="https://i.imgur.com/n57DPG3.png" alt="" />
</a></p>

<p>I fucking hate it. Why do I need to see my machine name every time I open the terminal? <a href="https://www.merriam-webster.com/dictionary/phooey">Phooey</a>.</p>

<p>Plus, when I navigate to a git repo, it doesn’t even show what branch I’m on. Double phooey.</p>

<!-- prettier-ignore -->
<p><a href="https://i.imgur.com/sNgVmfJ.png" aria-label="" data-lightbox="https://i.imgur.com/sNgVmfJ.png" class="lightbox-img">
  <img src="https://i.imgur.com/sNgVmfJ.png" alt="" />
</a></p>

<h2 id="my-setup">My setup</h2>

<p>Here’s what I have and I’m really happy with it.</p>

<!-- prettier-ignore -->
<p><a href="https://i.imgur.com/3Dwoh1Z.png" aria-label="" data-lightbox="https://i.imgur.com/3Dwoh1Z.png" class="lightbox-img">
  <img src="https://i.imgur.com/3Dwoh1Z.png" alt="" />
</a></p>

<h2 id="what-do-i-like-about-it">What do I like about it?</h2>

<p>Couple of things:</p>

<ul>
  <li>Shows me what user I’m logged in as (good on unix systems when you want to switch between root and normal user)</li>
  <li>Shows me the full (read FULL) path of where I am. Yes, FULL.</li>
  <li>Shows me the branch I’m on (if I’m in a git repo)</li>
</ul>

<p>Things I don’t need here:</p>

<ul>
  <li>Machine name</li>
  <li>Date</li>
  <li>10 billion colours</li>
  <li>Emoji.      <small><small><small>Well…</small></small></small></li>
</ul>

<h2 id="how-to-set-it-up">How to set it up</h2>

<p>If you’re really impressed by it and just want the code, copy paste the following in your <code class="language-plaintext highlighter-rouge">~/.bash_profile</code> and move on with your life.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git_prompt() {

    local branchName="";

    # Check if the current directory is in a Git repository.
    if git rev-parse --git-dir &gt; /dev/null 2&gt;&amp;1; then
        branchName="$(git symbolic-ref --quiet --short HEAD 2&gt; /dev/null || \
	        git rev-parse --short HEAD 2&gt; /dev/null || \
		    echo '(unknown)')";
        echo -e "(${branchName})";
    else
        return;
    fi;

}

PS1="\n[\u] at \w";

PS1+=" \$(git_prompt)";

PS1+="\n=&gt; ";
</code></pre></div></div>

<p>If you’re like me and want to understand what this gibberish means, read on.</p>

<p>The <code class="language-plaintext highlighter-rouge">git_prompt()</code> method spits out the current branch name, if it exists. Let’s try to break it down.</p>

<h2 id="step-1">Step 1</h2>

<p>Let’s run the first half of the command in a git repo and a normal folder and see what happens</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[kunalnagar] at ~/Documents/Code/personal-main (updates-v3)
=&gt; git rev-parse --git-dir
.git

[kunalnagar] at ~/Documents/Code/personal-main (updates-v3)
=&gt; cd ..

[kunalnagar] at ~/Documents/Code
=&gt; git rev-parse --git-dir
fatal: not a git repository (or any of the parent directories): .git
</code></pre></div></div>

<p>So basically, this command is used to check if our current working directory is a git repo or not.</p>

<p>What’s the writing to <code class="language-plaintext highlighter-rouge">/dev/null</code> and <code class="language-plaintext highlighter-rouge">2&gt;&amp;1</code> mean? Read more <a href="https://askubuntu.com/questions/12098/what-does-outputting-to-dev-null-accomplish-in-bash-scripts">here</a></p>

<h2 id="step-2">Step 2</h2>

<p>Once we’ve figured out that we are, actually, inside a git repo, we need to figure out what branch we’re in. Now please note that this can get fairly complicated with detached HEAD states etc. which is where most solutions on the internet fail. This is the best one I’ve found that works across a wide range of scenarios.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[kunalnagar] at ~/Documents/Code/personal-main (updates-v3)
=&gt; git symbolic-ref --quiet --short HEAD 2&gt; /dev/null
updates-v3

[kunalnagar] at ~/Documents/Code/personal-main (updates-v3)
=&gt; cd ..

[kunalnagar] at ~/Documents/Code
=&gt; git symbolic-ref --quiet --short HEAD 2&gt; /dev/null
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">git symbolic-ref</code> allows us to read, modify and delete <a href="https://stackoverflow.com/a/1526526">symbolic refs</a></p>

<p>For more information on the flags, check out <a href="https://git-scm.com/docs/git-symbolic-ref#git-symbolic-ref---quiet"><code class="language-plaintext highlighter-rouge">--quiet</code></a> and <a href="https://git-scm.com/docs/git-symbolic-ref#git-symbolic-ref---short"><code class="language-plaintext highlighter-rouge">--short</code></a></p>

<p>As you can see from the above example, when the above command is run, it spits out the branch name.</p>

<p>The <code class="language-plaintext highlighter-rouge">git rev-parse</code> is used as a safety net in scenarios like detached heads where we might need to pick out params from a lot of info</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[kunalnagar] at ~/Documents/Code/personal-main (updates-v3)
=&gt; git symbolic-ref --quiet --short HEAD 2&gt; /dev/null || git rev-parse
updates-v3
</code></pre></div></div>

<h2 id="step-3">Step 3</h2>

<p>Cool, now we have the branch name. Now we just need to set the bash variable <code class="language-plaintext highlighter-rouge">PS</code> to show our minimal prompt</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS1="\n[\u] at \w";
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">\n</code>: New line</p>

<p><code class="language-plaintext highlighter-rouge">\u</code>: Current user (name)</p>

<p><code class="language-plaintext highlighter-rouge">\w</code>: Path relative to home (notice the tilda in the path names in the screenshots)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS1+=" \$(git_prompt)";
</code></pre></div></div>

<p>This appends the branch name in parentheses (if it’s a git repo)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS1+="\n=&gt; ";
</code></pre></div></div>

<p>Just a new line. With a short arrow.</p>

<p>And we’re done! Hope this made sense. Bash scripting is fun. A side project I’m working on is to transition my SCSS compilation to CSS using Makefiles. Will post my findings soon.</p>
</article>
      </div>
      <footer>
  <script src="/assets/js/utils.js"></script>
  <script src="/assets/js/main.js"></script>
</footer>

    </main>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/css/lightbox.min.css"
    />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.1/js/lightbox.min.js"
      async
      defer
    ></script>
  </body>
</html>
